<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SparkSession과 SparkContext 이해하기 | Today I Learned</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="desc">
    
    <link rel="preload" href="/TIL/assets/css/0.styles.00bd70e4.css" as="style"><link rel="preload" href="/TIL/assets/js/app.dba3423c.js" as="script"><link rel="preload" href="/TIL/assets/js/2.83a6f128.js" as="script"><link rel="preload" href="/TIL/assets/js/1.322c5a0a.js" as="script"><link rel="preload" href="/TIL/assets/js/27.51b2d4dd.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.d9e4b84a.js"><link rel="prefetch" href="/TIL/assets/js/11.ccf2f442.js"><link rel="prefetch" href="/TIL/assets/js/12.7e65a11a.js"><link rel="prefetch" href="/TIL/assets/js/13.d4317b93.js"><link rel="prefetch" href="/TIL/assets/js/14.ea01d868.js"><link rel="prefetch" href="/TIL/assets/js/15.9da1bcf8.js"><link rel="prefetch" href="/TIL/assets/js/16.8727279f.js"><link rel="prefetch" href="/TIL/assets/js/17.fa7fb6b0.js"><link rel="prefetch" href="/TIL/assets/js/18.56419c05.js"><link rel="prefetch" href="/TIL/assets/js/19.42d46c09.js"><link rel="prefetch" href="/TIL/assets/js/20.100d0125.js"><link rel="prefetch" href="/TIL/assets/js/21.428690a9.js"><link rel="prefetch" href="/TIL/assets/js/22.53eda83e.js"><link rel="prefetch" href="/TIL/assets/js/23.377a507c.js"><link rel="prefetch" href="/TIL/assets/js/24.62a43f53.js"><link rel="prefetch" href="/TIL/assets/js/25.2cb61fbc.js"><link rel="prefetch" href="/TIL/assets/js/26.07decc26.js"><link rel="prefetch" href="/TIL/assets/js/28.86b66102.js"><link rel="prefetch" href="/TIL/assets/js/29.f2c2a0c0.js"><link rel="prefetch" href="/TIL/assets/js/3.e6df855e.js"><link rel="prefetch" href="/TIL/assets/js/30.33147ece.js"><link rel="prefetch" href="/TIL/assets/js/31.4cd27359.js"><link rel="prefetch" href="/TIL/assets/js/32.a6842c91.js"><link rel="prefetch" href="/TIL/assets/js/33.431c1871.js"><link rel="prefetch" href="/TIL/assets/js/34.53302144.js"><link rel="prefetch" href="/TIL/assets/js/35.d500be46.js"><link rel="prefetch" href="/TIL/assets/js/36.f4e6eb9f.js"><link rel="prefetch" href="/TIL/assets/js/37.eb0597c0.js"><link rel="prefetch" href="/TIL/assets/js/38.bcaf4fbf.js"><link rel="prefetch" href="/TIL/assets/js/39.c64a3043.js"><link rel="prefetch" href="/TIL/assets/js/4.cd02f05a.js"><link rel="prefetch" href="/TIL/assets/js/40.c4adbd8b.js"><link rel="prefetch" href="/TIL/assets/js/41.417973c2.js"><link rel="prefetch" href="/TIL/assets/js/42.c0d1a1f0.js"><link rel="prefetch" href="/TIL/assets/js/5.610977c8.js"><link rel="prefetch" href="/TIL/assets/js/6.b548e5bb.js"><link rel="prefetch" href="/TIL/assets/js/7.08600db3.js"><link rel="prefetch" href="/TIL/assets/js/vendors~docsearch.ef62c33d.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.00bd70e4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">Today I Learned</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/jang-hs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/jang-hs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/TIL/" aria-current="page" class="sidebar-link">Monthly I Learned</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>algorithm</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>data-engineer</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/data-engineer/241122-spark-rdd.html" class="sidebar-link">Apache Spark RDD(Resilient Distributed Dataset)</a></li><li><a href="/TIL/data-engineer/241126-spark-join.html" class="sidebar-link">Spark 조인(join) 최적화</a></li><li><a href="/TIL/data-engineer/241130-data-engnierring-for-ai-example.html" class="sidebar-link">예제로 살펴보는 AI를 위한 데이터 엔지니어링</a></li><li><a href="/TIL/data-engineer/241204-spark-session-context.html" aria-current="page" class="active sidebar-link">SparkSession과 SparkContext 이해하기</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/data-engineer/241204-spark-session-context.html#sparksession이란" class="sidebar-link">SparkSession이란?</a></li><li class="sidebar-sub-header"><a href="/TIL/data-engineer/241204-spark-session-context.html#왜-sparksession을-사용할까요" class="sidebar-link">왜 SparkSession을 사용할까요?</a></li><li class="sidebar-sub-header"><a href="/TIL/data-engineer/241204-spark-session-context.html#sparkcontext란" class="sidebar-link">SparkContext란?</a></li><li class="sidebar-sub-header"><a href="/TIL/data-engineer/241204-spark-session-context.html#왜-sparkcontext를-사용할까요" class="sidebar-link">왜 SparkContext를 사용할까요?</a></li><li class="sidebar-sub-header"><a href="/TIL/data-engineer/241204-spark-session-context.html#언제-무엇을-사용해야-할까요" class="sidebar-link">언제 무엇을 사용해야 할까요?</a></li><li class="sidebar-sub-header"><a href="/TIL/data-engineer/241204-spark-session-context.html#결론" class="sidebar-link">결론</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>design-pattern</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mlops</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>sql</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="sparksession과-sparkcontext-이해하기"><a href="#sparksession과-sparkcontext-이해하기" class="header-anchor">#</a> SparkSession과 SparkContext 이해하기</h1> <p><a href="https://medium.com/@santosh_beora/understanding-sparksession-and-sparkcontext-in-pyspark-e74ecc688886" target="_blank" rel="noopener noreferrer">Understanding SparkSession and SparkContext in PySpark<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>를 읽고 정리하였습니다.</p> <p>PySpark는 대규모 데이터 세트를 처리하기 위한 강력한 도구입니다. PySpark의 핵심 개념 중 두 가지는 <code>SparkSession</code>과 <code>SparkContext</code>입니다. 이를 간단하게 설명하고 몇 가지 예제를 통해 작동 방식을 살펴보겠습니다.</p> <h2 id="sparksession이란"><a href="#sparksession이란" class="header-anchor">#</a> SparkSession이란?</h2> <p><code>SparkSession</code>은 Spark 프로그래밍의 진입점입니다. Spark의 기능을 활용하고 DataFrame 및 DataSet을 생성할 수 있는 단일 진입점을 제공합니다.</p> <h2 id="왜-sparksession을-사용할까요"><a href="#왜-sparksession을-사용할까요" class="header-anchor">#</a> 왜 SparkSession을 사용할까요?</h2> <ol><li>통합 인터페이스: 기존의 <code>SQLContext</code>, <code>HiveContext</code>, <code>SparkContext</code>를 단일 진입점으로 통합합니다.</li> <li>사용 용이성: Spark 애플리케이션을 시작하고 구성하는 과정을 간소화합니다.</li></ol> <h3 id="예제"><a href="#예제" class="header-anchor">#</a> 예제</h3> <p>PySpark에서 <code>SparkSession</code>을 생성하는 방법은 다음과 같습니다:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> pyspark<span class="token punctuation">.</span>sql <span class="token keyword">import</span> SparkSession

<span class="token comment"># SparkSession 생성</span>
spark <span class="token operator">=</span> SparkSession<span class="token punctuation">.</span>builder \
    <span class="token punctuation">.</span>appName<span class="token punctuation">(</span><span class="token string">&quot;example_spark_session&quot;</span><span class="token punctuation">)</span> \
    <span class="token punctuation">.</span>getOrCreate<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><code>SparkSession.builder</code>: <code>SparkSession</code> 생성을 시작합니다.</li> <li><code>appName(&quot;example_spark_session&quot;)</code>: 애플리케이션의 이름을 설정합니다.</li> <li><code>getOrCreate()</code>: 기존에 존재하는 <code>SparkSession</code>을 가져오거나 새로 생성합니다.</li></ul> <h2 id="sparkcontext란"><a href="#sparkcontext란" class="header-anchor">#</a> SparkContext란?</h2> <p><code>SparkContext</code>는 Spark 기능의 원래 진입점입니다. Spark 클러스터에 연결하고 데이터를 로드하며, Spark의 핵심 기능과 상호작용하는 역할을 합니다.</p> <h2 id="왜-sparkcontext를-사용할까요"><a href="#왜-sparkcontext를-사용할까요" class="header-anchor">#</a> 왜 SparkContext를 사용할까요?</h2> <ol><li>저수준 작업 지원: 저수준 작업 및 구성을 사용할 수 있는 기능을 제공합니다.</li> <li>RDD 조작: Resilient Distributed Datasets(RDDs)을 직접 다루기 위해 필수적입니다.</li></ol> <h3 id="예제-2"><a href="#예제-2" class="header-anchor">#</a> 예제:</h3> <p>PySpark에서 <code>SparkContext</code>를 생성하는 방법은 다음과 같습니다:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> pyspark <span class="token keyword">import</span> SparkContext<span class="token punctuation">,</span> SparkConf

<span class="token comment"># Spark 구성 생성</span>
conf <span class="token operator">=</span> SparkConf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>setAppName<span class="token punctuation">(</span><span class="token string">&quot;example_spark_context&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># SparkContext 생성</span>
sc <span class="token operator">=</span> SparkContext<span class="token punctuation">(</span>conf<span class="token operator">=</span>conf<span class="token punctuation">)</span>
</code></pre></div><ul><li><code>SparkConf().setAppName(&quot;example_spark_context&quot;)</code>: Spark 설정에서 애플리케이션 이름을 설정합니다.</li> <li><code>SparkContext(conf=conf)</code>: 주어진 설정을 사용하여 <code>SparkContext</code>를 초기화합니다.</li></ul> <h2 id="언제-무엇을-사용해야-할까요"><a href="#언제-무엇을-사용해야-할까요" class="header-anchor">#</a> 언제 무엇을 사용해야 할까요?</h2> <ol><li><p>SparkSession:</p> <ul><li>DataFrame과 SQL 같은 고수준 API를 사용할 때 사용합니다.</li> <li>간단하고 통합된 인터페이스 덕분에 대부분의 데이터 처리 작업에 적합합니다.</li></ul></li> <li><p>SparkContext:</p> <ul><li>저수준 RDD 작업을 수행할 때 사용합니다.</li> <li>Spark 실행의 기본 요소를 더 많이 제어하거나 RDD를 직접 조작해야 할 때 필요합니다.</li></ul></li></ol> <h3 id="예제-3"><a href="#예제-3" class="header-anchor">#</a> 예제:</h3> <p><code>SparkSession</code>과 <code>SparkContext</code>를 함께 사용하는 방법을 살펴보겠습니다:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> pyspark<span class="token punctuation">.</span>sql <span class="token keyword">import</span> SparkSession

<span class="token comment"># SparkSession 생성</span>
spark <span class="token operator">=</span> SparkSession<span class="token punctuation">.</span>builder \
    <span class="token punctuation">.</span>appName<span class="token punctuation">(</span><span class="token string">&quot;example_spark_session&quot;</span><span class="token punctuation">)</span> \
    <span class="token punctuation">.</span>getOrCreate<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># SparkSession에서 SparkContext 가져오기</span>
sc <span class="token operator">=</span> spark<span class="token punctuation">.</span>sparkContext

<span class="token comment"># SparkContext를 사용하여 간단한 RDD 생성</span>
rdd <span class="token operator">=</span> sc<span class="token punctuation">.</span>parallelize<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># SparkSession을 사용하여 RDD를 DataFrame으로 변환</span>
df <span class="token operator">=</span> spark<span class="token punctuation">.</span>createDataFrame<span class="token punctuation">(</span>rdd<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;number&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># DataFrame 출력</span>
df<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ol><li><code>SparkSession</code>을 생성합니다.</li> <li><code>spark.sparkContext</code>를 사용해 기본 <code>SparkContext</code>에 접근합니다.</li> <li>숫자로 구성된 리스트에서 RDD를 생성합니다.</li> <li>RDD를 DataFrame으로 변환하고, <code>show()</code>를 사용해 출력합니다.</li></ol> <h2 id="결론"><a href="#결론" class="header-anchor">#</a> 결론</h2> <ul><li><code>SparkSession</code>: 사용하기 쉽고 통합된 인터페이스 덕분에 대부분의 데이터 처리 작업에 적합합니다.</li> <li><code>SparkContext</code>: 저수준 작업이나 RDD를 직접 다뤄야 할 때 사용합니다.</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/TIL/data-engineer/241130-data-engnierring-for-ai-example.html" class="prev">
        예제로 살펴보는 AI를 위한 데이터 엔지니어링
      </a></span> <span class="next"><a href="/TIL/design-pattern/241030-factory-decorator-pattern.html">
        팩토리 패턴과 데코레이터 패턴
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/TIL/assets/js/app.dba3423c.js" defer></script><script src="/TIL/assets/js/2.83a6f128.js" defer></script><script src="/TIL/assets/js/1.322c5a0a.js" defer></script><script src="/TIL/assets/js/27.51b2d4dd.js" defer></script>
  </body>
</html>
