<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>예제로 살펴보는 AI를 위한 데이터 엔지니어링 | Today I Learned</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="desc">
    
    <link rel="preload" href="/TIL/assets/css/0.styles.00bd70e4.css" as="style"><link rel="preload" href="/TIL/assets/js/app.dba3423c.js" as="script"><link rel="preload" href="/TIL/assets/js/2.83a6f128.js" as="script"><link rel="preload" href="/TIL/assets/js/1.322c5a0a.js" as="script"><link rel="preload" href="/TIL/assets/js/26.07decc26.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.d9e4b84a.js"><link rel="prefetch" href="/TIL/assets/js/11.ccf2f442.js"><link rel="prefetch" href="/TIL/assets/js/12.7e65a11a.js"><link rel="prefetch" href="/TIL/assets/js/13.d4317b93.js"><link rel="prefetch" href="/TIL/assets/js/14.ea01d868.js"><link rel="prefetch" href="/TIL/assets/js/15.9da1bcf8.js"><link rel="prefetch" href="/TIL/assets/js/16.8727279f.js"><link rel="prefetch" href="/TIL/assets/js/17.fa7fb6b0.js"><link rel="prefetch" href="/TIL/assets/js/18.56419c05.js"><link rel="prefetch" href="/TIL/assets/js/19.42d46c09.js"><link rel="prefetch" href="/TIL/assets/js/20.100d0125.js"><link rel="prefetch" href="/TIL/assets/js/21.428690a9.js"><link rel="prefetch" href="/TIL/assets/js/22.53eda83e.js"><link rel="prefetch" href="/TIL/assets/js/23.377a507c.js"><link rel="prefetch" href="/TIL/assets/js/24.62a43f53.js"><link rel="prefetch" href="/TIL/assets/js/25.2cb61fbc.js"><link rel="prefetch" href="/TIL/assets/js/27.51b2d4dd.js"><link rel="prefetch" href="/TIL/assets/js/28.86b66102.js"><link rel="prefetch" href="/TIL/assets/js/29.f2c2a0c0.js"><link rel="prefetch" href="/TIL/assets/js/3.e6df855e.js"><link rel="prefetch" href="/TIL/assets/js/30.33147ece.js"><link rel="prefetch" href="/TIL/assets/js/31.4cd27359.js"><link rel="prefetch" href="/TIL/assets/js/32.a6842c91.js"><link rel="prefetch" href="/TIL/assets/js/33.431c1871.js"><link rel="prefetch" href="/TIL/assets/js/34.53302144.js"><link rel="prefetch" href="/TIL/assets/js/35.d500be46.js"><link rel="prefetch" href="/TIL/assets/js/36.f4e6eb9f.js"><link rel="prefetch" href="/TIL/assets/js/37.eb0597c0.js"><link rel="prefetch" href="/TIL/assets/js/38.bcaf4fbf.js"><link rel="prefetch" href="/TIL/assets/js/39.c64a3043.js"><link rel="prefetch" href="/TIL/assets/js/4.cd02f05a.js"><link rel="prefetch" href="/TIL/assets/js/40.c4adbd8b.js"><link rel="prefetch" href="/TIL/assets/js/41.417973c2.js"><link rel="prefetch" href="/TIL/assets/js/42.c0d1a1f0.js"><link rel="prefetch" href="/TIL/assets/js/5.610977c8.js"><link rel="prefetch" href="/TIL/assets/js/6.b548e5bb.js"><link rel="prefetch" href="/TIL/assets/js/7.08600db3.js"><link rel="prefetch" href="/TIL/assets/js/vendors~docsearch.ef62c33d.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.00bd70e4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">Today I Learned</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/jang-hs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/jang-hs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/TIL/" aria-current="page" class="sidebar-link">Monthly I Learned</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>algorithm</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>data-engineer</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/data-engineer/241122-spark-rdd.html" class="sidebar-link">Apache Spark RDD(Resilient Distributed Dataset)</a></li><li><a href="/TIL/data-engineer/241126-spark-join.html" class="sidebar-link">Spark 조인(join) 최적화</a></li><li><a href="/TIL/data-engineer/241130-data-engnierring-for-ai-example.html" aria-current="page" class="active sidebar-link">예제로 살펴보는 AI를 위한 데이터 엔지니어링</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/data-engineer/241130-data-engnierring-for-ai-example.html#_1-ai-워크로드를-위한-데이터-파이프라인-구축" class="sidebar-link">1. AI 워크로드를 위한 데이터 파이프라인 구축</a></li><li class="sidebar-sub-header"><a href="/TIL/data-engineer/241130-data-engnierring-for-ai-example.html#_2-데이터-품질-및-관측성" class="sidebar-link">2. 데이터 품질 및 관측성</a></li><li class="sidebar-sub-header"><a href="/TIL/data-engineer/241130-data-engnierring-for-ai-example.html#_3-데이터-카탈로그-및-메타데이터-관리" class="sidebar-link">3. 데이터 카탈로그 및 메타데이터 관리</a></li><li class="sidebar-sub-header"><a href="/TIL/data-engineer/241130-data-engnierring-for-ai-example.html#_4-확장성을-위한-데이터-파티셔닝-및-인덱싱" class="sidebar-link">4. 확장성을 위한 데이터 파티셔닝 및 인덱싱</a></li><li class="sidebar-sub-header"><a href="/TIL/data-engineer/241130-data-engnierring-for-ai-example.html#_5-데이터-마스킹-및-익명화" class="sidebar-link">5. 데이터 마스킹 및 익명화</a></li><li class="sidebar-sub-header"><a href="/TIL/data-engineer/241130-data-engnierring-for-ai-example.html#결론" class="sidebar-link">결론</a></li></ul></li><li><a href="/TIL/data-engineer/241204-spark-session-context.html" class="sidebar-link">SparkSession과 SparkContext 이해하기</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>design-pattern</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mlops</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>sql</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="예제로-살펴보는-ai를-위한-데이터-엔지니어링"><a href="#예제로-살펴보는-ai를-위한-데이터-엔지니어링" class="header-anchor">#</a> 예제로 살펴보는 AI를 위한 데이터 엔지니어링</h1> <p><a href="https://blog.det.life/data-engineering-for-ai-practical-examples-and-best-practices-d40f9832f8dc?gi=b2932bdb277e" target="_blank" rel="noopener noreferrer">Data Engineering for AI: Practical Examples and Best Practices<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 를 읽고 정리했습니다.</p> <p>AI 기반 애플리케이션이 점점 더 널리 사용됨에 따라, AI를 위한 데이터 관리도 전문적인 기술과 강력한 프레임워크를 요구하는 복잡한 작업으로 발전했습니다. AI 데이터 엔지니어링을 예제를 통해 함께 알아봅니다.</p> <h2 id="_1-ai-워크로드를-위한-데이터-파이프라인-구축"><a href="#_1-ai-워크로드를-위한-데이터-파이프라인-구축" class="header-anchor">#</a> 1. AI 워크로드를 위한 데이터 파이프라인 구축</h2> <p>AI를 위한 데이터 파이프라인은 유연성과 확장성이 필요하며, 종종 배치(batch)와 스트리밍(streaming) 기능을 모두 요구합니다. Apache Spark와 Kafka를 사용하여 데이터를 처리하는 파이프라인 예제를 살펴보겠습니다.</p> <h3 id="예시-apache-spark와-kafka를-활용한-실시간-데이터-수집"><a href="#예시-apache-spark와-kafka를-활용한-실시간-데이터-수집" class="header-anchor">#</a> 예시: Apache Spark와 Kafka를 활용한 실시간 데이터 수집</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> pyspark<span class="token punctuation">.</span>sql <span class="token keyword">import</span> SparkSession  
<span class="token keyword">from</span> pyspark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>functions <span class="token keyword">import</span> from_json<span class="token punctuation">,</span> col  
<span class="token keyword">from</span> pyspark<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>types <span class="token keyword">import</span> StructType<span class="token punctuation">,</span> StructField<span class="token punctuation">,</span> StringType<span class="token punctuation">,</span> DoubleType  
  
<span class="token comment"># Define the schema for incoming data  </span>
schema <span class="token operator">=</span> StructType<span class="token punctuation">(</span><span class="token punctuation">[</span>  
    StructField<span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> StringType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    StructField<span class="token punctuation">(</span><span class="token string">&quot;timestamp&quot;</span><span class="token punctuation">,</span> StringType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    StructField<span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">,</span> DoubleType<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>  
<span class="token punctuation">]</span><span class="token punctuation">)</span>  
  
<span class="token comment"># Initialize Spark session  </span>
spark <span class="token operator">=</span> SparkSession<span class="token punctuation">.</span>builder \  
    <span class="token punctuation">.</span>appName<span class="token punctuation">(</span><span class="token string">&quot;AI Data Pipeline&quot;</span><span class="token punctuation">)</span> \  
    <span class="token punctuation">.</span>getOrCreate<span class="token punctuation">(</span><span class="token punctuation">)</span>  
  
<span class="token comment"># Read streaming data from Kafka  </span>
df <span class="token operator">=</span> spark \  
    <span class="token punctuation">.</span>readStream \  
    <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">&quot;kafka&quot;</span><span class="token punctuation">)</span> \  
    <span class="token punctuation">.</span>option<span class="token punctuation">(</span><span class="token string">&quot;kafka.bootstrap.servers&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;localhost:9092&quot;</span><span class="token punctuation">)</span> \  
    <span class="token punctuation">.</span>option<span class="token punctuation">(</span><span class="token string">&quot;subscribe&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;data-topic&quot;</span><span class="token punctuation">)</span> \  
    <span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>  
  
<span class="token comment"># Parse JSON data  </span>
parsed_df <span class="token operator">=</span> df<span class="token punctuation">.</span>select<span class="token punctuation">(</span>from_json<span class="token punctuation">(</span>col<span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cast<span class="token punctuation">(</span><span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> schema<span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;data.*&quot;</span><span class="token punctuation">)</span>  
  
<span class="token comment"># Apply transformations for AI model  </span>
transformed_df <span class="token operator">=</span> parsed_df<span class="token punctuation">.</span>withColumn<span class="token punctuation">(</span><span class="token string">&quot;feature&quot;</span><span class="token punctuation">,</span> col<span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># Example feature engineering  </span>
  
<span class="token comment"># Write to data sink  </span>
query <span class="token operator">=</span> transformed_df<span class="token punctuation">.</span>writeStream \  
    <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">&quot;console&quot;</span><span class="token punctuation">)</span> \  
    <span class="token punctuation">.</span>outputMode<span class="token punctuation">(</span><span class="token string">&quot;append&quot;</span><span class="token punctuation">)</span> \  
    <span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>  
  
query<span class="token punctuation">.</span>awaitTermination<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>이 예시에서는:</p> <ul><li>Kafka 토픽에서 Spark로 데이터를 가져와 변환 작업을 수행합니다.</li> <li>간단한 피쳐 변환(feature transformation)을 적용하여 새로운 피쳐 열(feature column)을 생성하며, 이는 이후 단계에서의 AI 모델에 유용할 수 있습니다.</li> <li>처리된 데이터는 콘솔, 데이터 레이크, 또는 실시간으로 AI 모델에 직접 출력할 수 있습니다.</li></ul> <h2 id="_2-데이터-품질-및-관측성"><a href="#_2-데이터-품질-및-관측성" class="header-anchor">#</a> 2. 데이터 품질 및 관측성</h2> <p>AI를 위해 데이터 품질을 보장하는 것은 매우 중요하며, 자동화된 품질 검사를 설정하면 오류를 크게 줄일 수 있습니다. Great Expectations를 사용하여 AI 모델로 데이터가 전달되기 전에 유입 데이터를 검증하는 예를 살펴보겠습니다.</p> <blockquote><p>great expectations는 python을 기반으로한 데이터 품질 평가 오픈소스 입니다. https://github.com/great-expectations/great_expectations 를 참고하세요</p></blockquote> <h3 id="예시-great-expectations를-활용한-데이터-검증"><a href="#예시-great-expectations를-활용한-데이터-검증" class="header-anchor">#</a> 예시: Great Expectations를 활용한 데이터 검증</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> great_expectations<span class="token punctuation">.</span>core<span class="token punctuation">.</span>batch <span class="token keyword">import</span> BatchRequest  
<span class="token keyword">from</span> great_expectations<span class="token punctuation">.</span>data_context <span class="token keyword">import</span> DataContext  
  
<span class="token comment"># Initialize Great Expectations context  </span>
context <span class="token operator">=</span> DataContext<span class="token punctuation">(</span><span class="token punctuation">)</span>  
  
<span class="token comment"># Define the data batch to validate  </span>
batch_request <span class="token operator">=</span> BatchRequest<span class="token punctuation">(</span>  
    datasource_name<span class="token operator">=</span><span class="token string">&quot;my_datasource&quot;</span><span class="token punctuation">,</span>  
    data_connector_name<span class="token operator">=</span><span class="token string">&quot;my_data_connector&quot;</span><span class="token punctuation">,</span>  
    data_asset_name<span class="token operator">=</span><span class="token string">&quot;my_table&quot;</span>  
<span class="token punctuation">)</span>  
  
<span class="token comment"># Define a new expectation suite  </span>
suite <span class="token operator">=</span> context<span class="token punctuation">.</span>create_expectation_suite<span class="token punctuation">(</span><span class="token string">&quot;ai_data_quality_suite&quot;</span><span class="token punctuation">,</span> overwrite_existing<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  
  
<span class="token comment"># Add data expectations  </span>
validator <span class="token operator">=</span> context<span class="token punctuation">.</span>get_validator<span class="token punctuation">(</span>batch_request<span class="token operator">=</span>batch_request<span class="token punctuation">,</span> expectation_suite_name<span class="token operator">=</span><span class="token string">&quot;ai_data_quality_suite&quot;</span><span class="token punctuation">)</span>  
validator<span class="token punctuation">.</span>expect_column_values_to_not_be_null<span class="token punctuation">(</span><span class="token string">&quot;timestamp&quot;</span><span class="token punctuation">)</span>  
validator<span class="token punctuation">.</span>expect_column_values_to_be_in_set<span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;active&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;inactive&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  
  
<span class="token comment"># Run validation and check results  </span>
results <span class="token operator">=</span> validator<span class="token punctuation">.</span>validate<span class="token punctuation">(</span><span class="token punctuation">)</span>  
<span class="token keyword">if</span> <span class="token keyword">not</span> results<span class="token punctuation">[</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">]</span><span class="token punctuation">:</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Data quality validation failed!&quot;</span><span class="token punctuation">)</span>  
<span class="token keyword">else</span><span class="token punctuation">:</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Data quality validation passed!&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>이 예시에서는:</p> <ul><li>Great Expectations를 사용하여 데이터의 주요 특성들을 검증합니다. 예를 들어, 비어 있지 않은 타임스탬프 값이나 상태 열(status column)에서 허용 가능한 상태를 확인합니다.</li> <li>이러한 검증은 AI 모델 학습 파이프라인에 데이터 이상값이 유입되기 전에 문제를 발견하는 데 도움을 줍니다.</li> <li>Great Expectations를 일반적인 예로 제시했지만, Splunk, SignalFx 또는 자체 개발한 도구와 같은 다른 프레임워크/도구를 선택할 수도 있습니다.</li></ul> <h2 id="_3-데이터-카탈로그-및-메타데이터-관리"><a href="#_3-데이터-카탈로그-및-메타데이터-관리" class="header-anchor">#</a> 3. 데이터 카탈로그 및 메타데이터 관리</h2> <p>풍부한 메타데이터를 포함한 데이터 카탈로그를 생성하면 데이터 과학자가 사용하는 데이터의 계보(lineage), 품질, 맥락(context)을 이해하는 데 도움을 줍니다. Apache Atlas를 사용하면 메타데이터를 프로그래밍 방식으로 카탈로그화할 수 있습니다.</p> <h3 id="예시-apache-atlas-api를-활용한-데이터-카탈로그화"><a href="#예시-apache-atlas-api를-활용한-데이터-카탈로그화" class="header-anchor">#</a> 예시: Apache Atlas API를 활용한 데이터 카탈로그화</h3> <p>Apache Atlas는 데이터셋, 테이블, 계보를 나타내는 엔티티를 생성하는 등 메타데이터를 관리할 수 있는 REST API를 제공합니다.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> requests  
<span class="token keyword">import</span> json  
  
<span class="token comment"># Define the entity details for a new dataset  </span>
entity <span class="token operator">=</span> <span class="token punctuation">{</span>  
    <span class="token string">&quot;entities&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>  
        <span class="token punctuation">{</span>  
            <span class="token string">&quot;typeName&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;hive_table&quot;</span><span class="token punctuation">,</span>  
            <span class="token string">&quot;attributes&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>  
                <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;sales_data&quot;</span><span class="token punctuation">,</span>  
                <span class="token string">&quot;qualifiedName&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;sales_data@prod&quot;</span><span class="token punctuation">,</span>  
                <span class="token string">&quot;description&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Sales data for AI model training&quot;</span><span class="token punctuation">,</span>  
                <span class="token string">&quot;owner&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;data_engineering_team&quot;</span><span class="token punctuation">,</span>  
                <span class="token string">&quot;tableType&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;MANAGED_TABLE&quot;</span><span class="token punctuation">,</span>  
                <span class="token string">&quot;columns&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>  
                    <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;timestamp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dataType&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;date&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  
                    <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;sale_amount&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dataType&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;double&quot;</span><span class="token punctuation">}</span>  
                <span class="token punctuation">]</span>  
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">]</span>  
<span class="token punctuation">}</span>  
  
<span class="token comment"># Send a POST request to create the entity  </span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>  
    <span class="token string">&quot;http://atlas-server:21000/api/atlas/v2/entity&quot;</span><span class="token punctuation">,</span>  
    headers<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  
    data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>entity<span class="token punctuation">)</span>  
<span class="token punctuation">)</span>  
  
<span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Entity created in Apache Atlas&quot;</span><span class="token punctuation">)</span>  
<span class="token keyword">else</span><span class="token punctuation">:</span>  
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Failed to create entity: </span><span class="token interpolation"><span class="token punctuation">{</span>response<span class="token punctuation">.</span>text<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token comment"># Define the entity details for a new dataset  </span>
entity <span class="token operator">=</span> <span class="token punctuation">{</span>  
    <span class="token string">&quot;entities&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>  
        <span class="token punctuation">{</span>  
            <span class="token string">&quot;typeName&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;hive_table&quot;</span><span class="token punctuation">,</span>  
            <span class="token string">&quot;attributes&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>  
                <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;sales_data&quot;</span><span class="token punctuation">,</span>  
                <span class="token string">&quot;qualifiedName&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;sales_data@prod&quot;</span><span class="token punctuation">,</span>  
                <span class="token string">&quot;description&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Sales data for AI model training&quot;</span><span class="token punctuation">,</span>  
                <span class="token string">&quot;owner&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;data_engineering_team&quot;</span><span class="token punctuation">,</span>  
                <span class="token string">&quot;tableType&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;MANAGED_TABLE&quot;</span><span class="token punctuation">,</span>  
                <span class="token string">&quot;columns&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>  
                    <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;timestamp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dataType&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;date&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  
                    <span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;sale_amount&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dataType&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;double&quot;</span><span class="token punctuation">}</span>  
                <span class="token punctuation">]</span>  
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">]</span>  
<span class="token punctuation">}</span>
</code></pre></div><p>이 예시에서는:</p> <ul><li>sales_data 테이블을 스키마, 소유자, 목적에 대한 메타데이터로 카탈로그화하여 AI 학습에 사용되는 데이터를 추적하고 이해하기 쉽게 만듭니다.</li></ul> <h2 id="_4-확장성을-위한-데이터-파티셔닝-및-인덱싱"><a href="#_4-확장성을-위한-데이터-파티셔닝-및-인덱싱" class="header-anchor">#</a> 4. 확장성을 위한 데이터 파티셔닝 및 인덱싱</h2> <p>데이터 파티셔닝과 인덱싱은 특히 분산 시스템에서 성능을 향상시킬 수 있습니다. Delta Lake를 사용한 파티셔닝과 인덱싱 예제를 살펴보겠습니다.</p> <h3 id="예시-delta-lake를-활용한-파티셔닝과-인덱싱"><a href="#예시-delta-lake를-활용한-파티셔닝과-인덱싱" class="header-anchor">#</a> 예시: Delta Lake를 활용한 파티셔닝과 인덱싱</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> delta<span class="token punctuation">.</span>tables <span class="token keyword">import</span> DeltaTable  
<span class="token keyword">from</span> pyspark<span class="token punctuation">.</span>sql <span class="token keyword">import</span> SparkSession  
  
spark <span class="token operator">=</span> SparkSession<span class="token punctuation">.</span>builder \  
    <span class="token punctuation">.</span>appName<span class="token punctuation">(</span><span class="token string">&quot;Delta Lake Example&quot;</span><span class="token punctuation">)</span> \  
    <span class="token punctuation">.</span>getOrCreate<span class="token punctuation">(</span><span class="token punctuation">)</span>  
  
<span class="token comment"># Load data and write with partitioning  </span>
df <span class="token operator">=</span> spark<span class="token punctuation">.</span>read<span class="token punctuation">.</span>csv<span class="token punctuation">(</span><span class="token string">&quot;s3://my-bucket/data.csv&quot;</span><span class="token punctuation">)</span>  
df<span class="token punctuation">.</span>write<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">&quot;delta&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>partitionBy<span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">&quot;/delta/sales_data&quot;</span><span class="token punctuation">)</span>  
  
<span class="token comment"># Optimize and create Z-Order index on relevant columns  </span>
delta_table <span class="token operator">=</span> DeltaTable<span class="token punctuation">.</span>forPath<span class="token punctuation">(</span>spark<span class="token punctuation">,</span> <span class="token string">&quot;/delta/sales_data&quot;</span><span class="token punctuation">)</span>  
delta_table<span class="token punctuation">.</span>optimize<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>executeZOrderBy<span class="token punctuation">(</span><span class="token string">&quot;customer_id&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>이 예시에서는:</p> <ul><li>sales_data를 날짜별로 파티셔닝하여 데이터 스캔 크기를 줄여 쿼리 성능을 향상시킵니다.</li> <li>customer_id에 Z-Order 인덱싱을 적용하여 해당 열에 대한 읽기 성능을 최적화하고, downstream AI 프로세스(예: 고객 맞춤형 모델)를 더 빠르게 만듭니다.</li></ul> <h2 id="_5-데이터-마스킹-및-익명화"><a href="#_5-데이터-마스킹-및-익명화" class="header-anchor">#</a> 5. 데이터 마스킹 및 익명화</h2> <p>민감한 데이터를 처리할 때 익명화는 필수적입니다. 다음 예시는 Python의 Faker 라이브러리를 사용하여 원본 데이터셋의 구조와 분포를 유지하면서 합성된 익명화된 데이터를 생성하는 방법을 보여줍니다.</p> <h3 id="예시-python의-faker를-사용한-데이터-마스킹"><a href="#예시-python의-faker를-사용한-데이터-마스킹" class="header-anchor">#</a> 예시: Python의 Faker를 사용한 데이터 마스킹</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> faker <span class="token keyword">import</span> Faker  
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  
  
fake <span class="token operator">=</span> Faker<span class="token punctuation">(</span><span class="token punctuation">)</span>  
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span>  
    <span class="token string">&quot;customer_id&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>fake<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
    <span class="token string">&quot;customer_name&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>fake<span class="token punctuation">.</span>name<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
    <span class="token string">&quot;transaction_amount&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>fake<span class="token punctuation">.</span>random_number<span class="token punctuation">(</span>digits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
  
<span class="token comment"># Display anonymized data  </span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p>이 예시에서는:</p> <ul><li>Faker가 고객 ID를 위한 가짜 UUID, 합성된 이름, 임의의 거래 금액을 생성합니다.</li> <li>이 익명화된 데이터셋은 고객 개인정보를 위험에 빠뜨리지 않고 AI 모델 학습과 테스트에 안전하게 사용할 수 있습니다.</li> <li>Faker를 일반적인 예로 사용했지만, PySyft, Presidio, SDV 등과 같은 다양한 마스킹 라이브러리가 있습니다. 사용자 정의 함수를 구축할 수도 있습니다.</li></ul> <h2 id="결론"><a href="#결론" class="header-anchor">#</a> 결론</h2> <p>AI를 위한 데이터 관리에는 전통적인 데이터 엔지니어링 기술과 AI 에서 발생하는 문제를 처리하기 위한 전문 기술이 결합됩니다. 스트리밍 수집, 데이터 검증, 카탈로그화, 파티셔닝, 마스킹과 같은 예시를 통해 이러한 기술들이 어떻게 AI 워크로드를 지원하는지 알 수 있습니다. AI를 위한 데이터 엔지니어링의 분야는 방대하며, AI가 발전함에 따라 이러한 도구와 모범 사례에 대한 숙련도를 유지하는 것이 중요합니다.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/TIL/data-engineer/241126-spark-join.html" class="prev">
        Spark 조인(join) 최적화
      </a></span> <span class="next"><a href="/TIL/data-engineer/241204-spark-session-context.html">
        SparkSession과 SparkContext 이해하기
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/TIL/assets/js/app.dba3423c.js" defer></script><script src="/TIL/assets/js/2.83a6f128.js" defer></script><script src="/TIL/assets/js/1.322c5a0a.js" defer></script><script src="/TIL/assets/js/26.07decc26.js" defer></script>
  </body>
</html>
