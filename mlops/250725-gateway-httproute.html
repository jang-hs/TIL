<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gateway API와 HTTPRoute | Today I Learned</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="desc">
    
    <link rel="preload" href="/TIL/assets/css/0.styles.00bd70e4.css" as="style"><link rel="preload" href="/TIL/assets/js/app.dba3423c.js" as="script"><link rel="preload" href="/TIL/assets/js/2.83a6f128.js" as="script"><link rel="preload" href="/TIL/assets/js/1.322c5a0a.js" as="script"><link rel="preload" href="/TIL/assets/js/39.c64a3043.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.d9e4b84a.js"><link rel="prefetch" href="/TIL/assets/js/11.ccf2f442.js"><link rel="prefetch" href="/TIL/assets/js/12.7e65a11a.js"><link rel="prefetch" href="/TIL/assets/js/13.d4317b93.js"><link rel="prefetch" href="/TIL/assets/js/14.ea01d868.js"><link rel="prefetch" href="/TIL/assets/js/15.9da1bcf8.js"><link rel="prefetch" href="/TIL/assets/js/16.8727279f.js"><link rel="prefetch" href="/TIL/assets/js/17.fa7fb6b0.js"><link rel="prefetch" href="/TIL/assets/js/18.56419c05.js"><link rel="prefetch" href="/TIL/assets/js/19.42d46c09.js"><link rel="prefetch" href="/TIL/assets/js/20.100d0125.js"><link rel="prefetch" href="/TIL/assets/js/21.428690a9.js"><link rel="prefetch" href="/TIL/assets/js/22.53eda83e.js"><link rel="prefetch" href="/TIL/assets/js/23.377a507c.js"><link rel="prefetch" href="/TIL/assets/js/24.62a43f53.js"><link rel="prefetch" href="/TIL/assets/js/25.2cb61fbc.js"><link rel="prefetch" href="/TIL/assets/js/26.07decc26.js"><link rel="prefetch" href="/TIL/assets/js/27.51b2d4dd.js"><link rel="prefetch" href="/TIL/assets/js/28.86b66102.js"><link rel="prefetch" href="/TIL/assets/js/29.f2c2a0c0.js"><link rel="prefetch" href="/TIL/assets/js/3.e6df855e.js"><link rel="prefetch" href="/TIL/assets/js/30.33147ece.js"><link rel="prefetch" href="/TIL/assets/js/31.4cd27359.js"><link rel="prefetch" href="/TIL/assets/js/32.a6842c91.js"><link rel="prefetch" href="/TIL/assets/js/33.431c1871.js"><link rel="prefetch" href="/TIL/assets/js/34.53302144.js"><link rel="prefetch" href="/TIL/assets/js/35.d500be46.js"><link rel="prefetch" href="/TIL/assets/js/36.f4e6eb9f.js"><link rel="prefetch" href="/TIL/assets/js/37.eb0597c0.js"><link rel="prefetch" href="/TIL/assets/js/38.bcaf4fbf.js"><link rel="prefetch" href="/TIL/assets/js/4.cd02f05a.js"><link rel="prefetch" href="/TIL/assets/js/40.c4adbd8b.js"><link rel="prefetch" href="/TIL/assets/js/41.417973c2.js"><link rel="prefetch" href="/TIL/assets/js/42.c0d1a1f0.js"><link rel="prefetch" href="/TIL/assets/js/5.610977c8.js"><link rel="prefetch" href="/TIL/assets/js/6.b548e5bb.js"><link rel="prefetch" href="/TIL/assets/js/7.08600db3.js"><link rel="prefetch" href="/TIL/assets/js/vendors~docsearch.ef62c33d.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.00bd70e4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">Today I Learned</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/jang-hs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/jang-hs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/TIL/" aria-current="page" class="sidebar-link">Monthly I Learned</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>algorithm</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>data-engineer</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>design-pattern</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>mlops</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/mlops/241109-mlops-data-testing.html" class="sidebar-link">MLOps 01: Data testing, why, what and how</a></li><li><a href="/TIL/mlops/241110-mlops-dagstar.html" class="sidebar-link">MLOps 02: Dagster — Seamless Data Pipelines &amp; ML Model Management for Machine Learning Engineers</a></li><li><a href="/TIL/mlops/241111-mlops-featurestore.html" class="sidebar-link">MLOps 03: Feast Feature Store — An In-depth Overview Experimentation and Application in Tabular data</a></li><li><a href="/TIL/mlops/241120-devops-metric-monitoring-alert.html" class="sidebar-link">Metrics Monitoring and Alerting system</a></li><li><a href="/TIL/mlops/241124-docker-multistage.html" class="sidebar-link">도커 멀티스테이징</a></li><li><a href="/TIL/mlops/241125-devops-k8s-probe.html" class="sidebar-link">Kubernetes의 Probe 알아보기</a></li><li><a href="/TIL/mlops/241127-devops-k8s-hpa.html" class="sidebar-link">Kubernetes HPA (Horizontal Pod Autoscaler) 알아보기</a></li><li><a href="/TIL/mlops/250414-k8s-hard-way-01.html" class="sidebar-link">[k8s hard way] 01-prerequisites 실습</a></li><li><a href="/TIL/mlops/250415-k8s-hard-way-02.html" class="sidebar-link">[k8s hard way] 02-Jumpbox 설정</a></li><li><a href="/TIL/mlops/250725-gateway-httproute.html" aria-current="page" class="active sidebar-link">Gateway API와 HTTPRoute</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/mlops/250725-gateway-httproute.html#_1-gateway-api란-무엇인가" class="sidebar-link">1. Gateway API란 무엇인가?</a></li><li class="sidebar-sub-header"><a href="/TIL/mlops/250725-gateway-httproute.html#_2-httproute란-무엇인가" class="sidebar-link">2. HTTPRoute란 무엇인가?</a></li><li class="sidebar-sub-header"><a href="/TIL/mlops/250725-gateway-httproute.html#_3-ingress-vs-gateway-api-왜-전환해야-하는가" class="sidebar-link">3. Ingress vs Gateway API – 왜 전환해야 하는가?</a></li><li class="sidebar-sub-header"><a href="/TIL/mlops/250725-gateway-httproute.html#_4-실전-비교-예시" class="sidebar-link">4. 실전 비교 예시</a></li><li class="sidebar-sub-header"><a href="/TIL/mlops/250725-gateway-httproute.html#_5-gateway-api-고급-트래픽-관리" class="sidebar-link">5. Gateway API 고급 트래픽 관리</a></li><li class="sidebar-sub-header"><a href="/TIL/mlops/250725-gateway-httproute.html#_6-gateway-api-마이그레이션-가이드-ingress에서-전환하기" class="sidebar-link">6. Gateway API 마이그레이션 가이드 (Ingress에서 전환하기)</a></li><li class="sidebar-sub-header"><a href="/TIL/mlops/250725-gateway-httproute.html#_7-마무리" class="sidebar-link">7. 마무리</a></li></ul></li><li><a href="/TIL/mlops/250727-network-policy.html" class="sidebar-link">Kubernetes NetworkPolicy</a></li><li><a href="/TIL/mlops/250727-quota-limits.html" class="sidebar-link">LimitRange와 ResourceQuota</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>sql</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="gateway-api와-httproute"><a href="#gateway-api와-httproute" class="header-anchor">#</a> Gateway API와 HTTPRoute</h1> <p>Kubernetes에서 외부 트래픽을 내부 서비스로 연결할 때 가장 많이 사용되는 리소스는 Ingress입니다. Ingress는 간단하고 직관적인 설정 덕분에 초창기 Kubernetes 사용자들에게 필수 도구로 자리잡았습니다. 하지만 대규모 마이크로서비스 환경이나 다중 팀 협업 체계에서는 세밀한 트래픽 제어, 보안 관리, 확장성 등의 요구를 만족시키기 어려워졌습니다. 이를 해결하기 위해 Kubernetes SIG-Network에서 개발한 Gateway API가 등장했습니다.</p> <p>이번 글에서는 Gateway API와 HTTPRoute의 개념, Ingress와의 실전 비교, 그리고 Ingress에서 Gateway API로 마이그레이션하는 가이드까지 종합적으로 다뤄보겠습니다.</p> <h2 id="_1-gateway-api란-무엇인가"><a href="#_1-gateway-api란-무엇인가" class="header-anchor">#</a> 1. Gateway API란 무엇인가?</h2> <p>Gateway API는 Ingress를 대체하거나 보완하기 위해 만들어진 차세대 트래픽 관리 표준입니다. 기존 Ingress가 단일 객체로 모든 규칙을 관리했다면, Gateway API는 역할을 분리하여 더 유연하고 확장 가능한 구조를 제공합니다.</p> <ul><li>GatewayClass: Gateway를 구현하는 컨트롤러를 정의합니다. 예: NGINX, Istio, Kong Gateway.</li> <li>Gateway: L4 레벨에서 트래픽을 수용하는 진입점(Entry Point).</li> <li>Route (HTTPRoute, TCPRoute, GRPCRoute 등): L7 레벨에서 호스트, 경로, 헤더, 쿼리 조건에 따라 트래픽을 세밀하게 라우팅.</li></ul> <p>이러한 구조는 운영팀과 개발팀 간의 역할 분리, 보안 및 멀티 프로토콜 지원, 확장성 강화라는 장점을 제공합니다.</p> <h2 id="_2-httproute란-무엇인가"><a href="#_2-httproute란-무엇인가" class="header-anchor">#</a> 2. HTTPRoute란 무엇인가?</h2> <p><code>HTTPRoute</code>는 Gateway API의 핵심 리소스로, HTTP 및 HTTPS 트래픽을 세밀하게 제어할 수 있습니다.</p> <ul><li>Hostnames, Path, Headers, Query 기반 매칭을 지원.</li> <li>요청/응답 필터링, URL Rewrite, Redirect 등의 고급 기능을 표준 스펙으로 제공합니다.</li> <li>Canary 배포와 A/B 테스트를 간단히 구성할 수 있습니다.</li></ul> <p>예시:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> gateway.networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> HTTPRoute
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> example<span class="token punctuation">-</span>route
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">parentRefs</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> example<span class="token punctuation">-</span>gateway
  <span class="token key atrule">hostnames</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;example.com&quot;</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">matches</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span>
            <span class="token key atrule">type</span><span class="token punctuation">:</span> PathPrefix
            <span class="token key atrule">value</span><span class="token punctuation">:</span> /api
      <span class="token key atrule">backendRefs</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> service<span class="token punctuation">-</span>a
          <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre></div><p>이 설정은 <code>example.com/api</code>로 들어오는 요청을 <code>service-a</code>로 라우팅합니다.</p> <h2 id="_3-ingress-vs-gateway-api-왜-전환해야-하는가"><a href="#_3-ingress-vs-gateway-api-왜-전환해야-하는가" class="header-anchor">#</a> 3. Ingress vs Gateway API – 왜 전환해야 하는가?</h2> <p>Ingress는 단순성과 빠른 설정이 장점이지만, 고급 라우팅과 다중 팀 관리에는 한계가 있습니다. Gateway API는 역할을 분리하여 관리 편의성을 높이고, 더 다양한 트래픽 제어 기능을 제공합니다.</p> <p>| 항목        | Ingress      | Gateway API                   |
|  |  | -- |
| 구조        | 단일 객체        | Gateway + Route로 역할 분리        |
| 확장성       | 제한적          | 다양한 Route 리소스(TCP, gRPC 등) 지원 |
| Canary 배포 | 컨트롤러 종속      | 표준 스펙으로 지원                    |
| 고급 라우팅    | Path/Host 기반 | Path, Host, Header, Query 기반  |
| TLS 관리    | 간단하나 제한적     | 리스너 단위 TLS 관리 가능              |
| 협업 구조     | 충돌 가능성 높음    | 팀별 HTTPRoute 관리 가능            |</p> <h2 id="_4-실전-비교-예시"><a href="#_4-실전-비교-예시" class="header-anchor">#</a> 4. 실전 비교 예시</h2> <h3 id="ingress-예시"><a href="#ingress-예시" class="header-anchor">#</a> Ingress 예시</h3> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> example<span class="token punctuation">-</span>ingress
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> <span class="token string">&quot;example.com&quot;</span>
      <span class="token key atrule">http</span><span class="token punctuation">:</span>
        <span class="token key atrule">paths</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /api
            <span class="token key atrule">pathType</span><span class="token punctuation">:</span> Prefix
            <span class="token key atrule">backend</span><span class="token punctuation">:</span>
              <span class="token key atrule">service</span><span class="token punctuation">:</span>
                <span class="token key atrule">name</span><span class="token punctuation">:</span> service<span class="token punctuation">-</span>a
                <span class="token key atrule">port</span><span class="token punctuation">:</span>
                  <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre></div><p>Ingress는 단일 객체에서 모든 규칙을 정의하므로 서비스가 많아질수록 관리가 복잡해집니다.</p> <h3 id="gateway-httproute-예시"><a href="#gateway-httproute-예시" class="header-anchor">#</a> Gateway + HTTPRoute 예시</h3> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> gateway.networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Gateway
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> example<span class="token punctuation">-</span>gateway
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">gatewayClassName</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">listeners</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> http
      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> HTTP
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>

<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> gateway.networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> HTTPRoute
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> api<span class="token punctuation">-</span>route
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">parentRefs</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> example<span class="token punctuation">-</span>gateway
  <span class="token key atrule">hostnames</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;example.com&quot;</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">matches</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span>
            <span class="token key atrule">type</span><span class="token punctuation">:</span> PathPrefix
            <span class="token key atrule">value</span><span class="token punctuation">:</span> /api
      <span class="token key atrule">backendRefs</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> service<span class="token punctuation">-</span>a
          <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre></div><p>이 구조에서는 Gateway와 HTTPRoute를 분리해 관리하므로 팀 간 충돌이 줄어듭니다.</p> <h2 id="_5-gateway-api-고급-트래픽-관리"><a href="#_5-gateway-api-고급-트래픽-관리" class="header-anchor">#</a> 5. Gateway API 고급 트래픽 관리</h2> <h3 id="_1-canary-배포"><a href="#_1-canary-배포" class="header-anchor">#</a> (1) Canary 배포</h3> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">matches</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span>
          <span class="token key atrule">type</span><span class="token punctuation">:</span> PathPrefix
          <span class="token key atrule">value</span><span class="token punctuation">:</span> /api
    <span class="token key atrule">backendRefs</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> service<span class="token punctuation">-</span>v1
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
        <span class="token key atrule">weight</span><span class="token punctuation">:</span> <span class="token number">70</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> service<span class="token punctuation">-</span>v2
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
        <span class="token key atrule">weight</span><span class="token punctuation">:</span> <span class="token number">30</span>
</code></pre></div><p>70%는 <code>service-v1</code>, 30%는 <code>service-v2</code>로 트래픽을 보낼 수 있습니다.</p> <h3 id="_2-헤더-기반-라우팅"><a href="#_2-헤더-기반-라우팅" class="header-anchor">#</a> (2) 헤더 기반 라우팅</h3> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">matches</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">headers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> X<span class="token punctuation">-</span>Canary
        <span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
</code></pre></div><p>특정 헤더가 포함된 요청만 Canary 서비스로 전달할 수 있습니다.</p> <h3 id="_3-요청-응답-필터링"><a href="#_3-요청-응답-필터링" class="header-anchor">#</a> (3) 요청/응답 필터링</h3> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">filters</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> RequestHeaderModifier
    <span class="token key atrule">requestHeaderModifier</span><span class="token punctuation">:</span>
      <span class="token key atrule">add</span><span class="token punctuation">:</span>
        <span class="token key atrule">X-Version</span><span class="token punctuation">:</span> <span class="token string">&quot;v1&quot;</span>
  <span class="token punctuation">-</span> <span class="token key atrule">type</span><span class="token punctuation">:</span> URLRewrite
    <span class="token key atrule">urlRewrite</span><span class="token punctuation">:</span>
      <span class="token key atrule">path</span><span class="token punctuation">:</span>
        <span class="token key atrule">type</span><span class="token punctuation">:</span> ReplaceFullPath
        <span class="token key atrule">replace</span><span class="token punctuation">:</span> /v1/api
</code></pre></div><p>URL을 재작성하거나 헤더를 추가하는 등의 고급 처리가 가능합니다.</p> <h2 id="_6-gateway-api-마이그레이션-가이드-ingress에서-전환하기"><a href="#_6-gateway-api-마이그레이션-가이드-ingress에서-전환하기" class="header-anchor">#</a> 6. Gateway API 마이그레이션 가이드 (Ingress에서 전환하기)</h2> <p>Ingress를 이미 사용 중이라면 Gateway API로 전환하기 위해 다음 단계를 거칠 수 있습니다.</p> <h3 id="_1-gatewayclass-선택"><a href="#_1-gatewayclass-선택" class="header-anchor">#</a> (1) GatewayClass 선택</h3> <ul><li>사용 중인 Ingress Controller(NGINX, Kong, Istio 등)가 Gateway API를 지원하는지 확인.</li> <li><code>GatewayClass</code> 리소스를 정의하여 사용할 컨트롤러를 지정합니다.</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> gateway.networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> GatewayClass
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">controllerName</span><span class="token punctuation">:</span> k8s.io/nginx
</code></pre></div><h3 id="_2-gateway-생성"><a href="#_2-gateway-생성" class="header-anchor">#</a> (2) Gateway 생성</h3> <p>Ingress의 <code>spec.rules</code>에 있던 host와 port 정보를 Gateway의 <code>listeners</code>로 이전합니다.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> gateway.networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Gateway
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> example<span class="token punctuation">-</span>gateway
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">gatewayClassName</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">listeners</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> http
      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> HTTP
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre></div><h3 id="_3-httproute로-라우팅-규칙-변환"><a href="#_3-httproute로-라우팅-규칙-변환" class="header-anchor">#</a> (3) HTTPRoute로 라우팅 규칙 변환</h3> <p>Ingress의 <code>rules</code>와 <code>paths</code>를 HTTPRoute의 <code>hostnames</code>와 <code>rules.matches</code>로 변환합니다.</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> gateway.networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> HTTPRoute
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> api<span class="token punctuation">-</span>route
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">parentRefs</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> example<span class="token punctuation">-</span>gateway
  <span class="token key atrule">hostnames</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;example.com&quot;</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">matches</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span>
            <span class="token key atrule">type</span><span class="token punctuation">:</span> PathPrefix
            <span class="token key atrule">value</span><span class="token punctuation">:</span> /api
      <span class="token key atrule">backendRefs</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> service<span class="token punctuation">-</span>a
          <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre></div><h3 id="_4-점진적-전환"><a href="#_4-점진적-전환" class="header-anchor">#</a> (4) 점진적 전환</h3> <ul><li>초기에는 Ingress와 Gateway API를 병행하여 동작시킬 수 있습니다.</li> <li>트래픽을 점차 Gateway로 이전하면서 Canary 전략으로 안정성을 확보합니다.</li></ul> <h3 id="_5-helm-차트-ci-파이프라인-수정"><a href="#_5-helm-차트-ci-파이프라인-수정" class="header-anchor">#</a> (5) Helm 차트/CI 파이프라인 수정</h3> <ul><li>기존 Ingress 리소스를 관리하던 Helm 차트나 GitOps 파이프라인을 Gateway + HTTPRoute 구조로 업데이트합니다.</li></ul> <h2 id="_7-마무리"><a href="#_7-마무리" class="header-anchor">#</a> 7. 마무리</h2> <p>Gateway API와 HTTPRoute는 Kubernetes 네트워크 트래픽 관리의 미래 표준으로 자리잡고 있습니다. Ingress의 한계를 넘어, Canary 배포, A/B 테스트, 헤더 기반 라우팅 같은 고급 기능을 표준화된 방법으로 제공합니다.
기존 Ingress 사용자는 Gateway API로 점진적 마이그레이션을 고려하여 더 유연하고 안정적인 트래픽 관리 환경을 구축할 수 있습니다.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/TIL/mlops/250415-k8s-hard-way-02.html" class="prev">
        [k8s hard way] 02-Jumpbox 설정
      </a></span> <span class="next"><a href="/TIL/mlops/250727-network-policy.html">
        Kubernetes NetworkPolicy
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/TIL/assets/js/app.dba3423c.js" defer></script><script src="/TIL/assets/js/2.83a6f128.js" defer></script><script src="/TIL/assets/js/1.322c5a0a.js" defer></script><script src="/TIL/assets/js/39.c64a3043.js" defer></script>
  </body>
</html>
